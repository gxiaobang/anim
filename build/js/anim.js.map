{"version":3,"sources":["anim.js"],"names":[],"mappings":"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","file":"anim.js","sourcesContent":["/**\r\n * tw.js\r\n * 轻量级的动画补间库\r\n * by bang\r\n */\r\n\r\nimport { getDOM, getStyle, setStyle, requestAnim } from './util.js';\r\nimport { tween } from './Tween.js';\r\n\r\n// 补间动画\r\nclass Anim {\r\n\tconstructor(el, options) {\r\n\t\tthis.el = getDOM(el)[0];\r\n\t\tthis.fn = {};\r\n\t\tthis.from = options.from || {};\r\n\t\tthis.to = options.to || {};\r\n\t\tthis.duration = Anim.toMs(options.duration) || '400';\r\n\t\tthis.easeFn = Anim.getTween(options.tween);\r\n\t\tthis.run();\r\n\t}\r\n\t// 运行\r\n\trun() {\r\n\t\tthis.begin();\r\n\t\tconst loop = () => {\r\n\t\t\tthis.elespedTime = +new Date - this.startTime;\r\n\t\t\tif (this.elespedTime > this.duration) {\r\n\t\t\t\tthis.complete();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.moving();\r\n\t\t\t\trequestAnim(loop);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\trequestAnim(loop);\r\n\t}\r\n\t// 开始\r\n\tbegin() {\r\n\t\tthis.startTime = +new Date;\r\n\t\tfor (let name in this.to) {\r\n\t\t\tif (!this.from.hasOwnProperty(name)) {\r\n\t\t\t\tthis.from[ name ] = parseFloat(getStyle(this.el, name));\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.fn.begin && this.fn.begin();\r\n\t}\r\n\t// 执行动画中，按fps触发\r\n\tmoving() {\r\n\t\tlet t, b, c, d;\r\n\t\tfor (let name in this.to) {\r\n\t\t\tt = this.elespedTime;\r\n\t\t\tb = parseFloat(this.from[name]);\r\n\t\t\tc = parseFloat(this.to[name]) - b;\r\n\t\t\td = this.duration;\r\n\r\n\t\t\tsetStyle(this.el, name, this.easeFn(t, b, c, d));\r\n\t\t}\r\n\t\tthis.fn.moving && this.fn.moving();\r\n\t}\r\n\t// 完成动画\r\n\tcomplete() {\r\n\t\tsetStyle(this.el, this.to);\r\n\t\tthis.fn.complete && this.fn.complete();\r\n\t}\r\n\r\n\t// 转化成毫秒\r\n\tstatic toMs(ms) {\r\n\t\treturn /\\ds$/.test(ms) ? parseFloat(ms) * 1000 : parseFloat(ms);\r\n\t}\r\n\r\n\t// 获取缓动公式\r\n\tstatic getTween(tween) {\r\n\t\tlet arr = tween.split('.');\r\n\t\tif (arr[0] == 'Linear') {\r\n\t\t\treturn Tween[arr[0]];\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn Tween[arr[0]][arr[1]];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport const anim = (el, props) => {\r\n\tnew Anim(el, props);\r\n};"],"sourceRoot":"/source/"}